2024-04-20 22:55:31.188726: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-04-20 22:55:31.189711: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-04-20 22:55:31.191799: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-04-20 22:55:31.204654: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-04-20 22:55:32.609869: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[nltk_data] Downloading package punkt to
[nltk_data]     /home/abdelrahman.sadallah/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
/home/abdelrahman.sadallah/mambaforge/envs/nlp/lib/python3.10/site-packages/torch/__init__.py:696: UserWarning: torch.set_default_tensor_type() is deprecated as of PyTorch 2.1, please use torch.set_default_dtype() and torch.set_default_device() as alternatives. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:451.)
  _C._set_default_tensor_type(t)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:22<13:08, 22.53s/it]  6%|▌         | 2/36 [00:43<12:13, 21.56s/it]  8%|▊         | 3/36 [01:08<12:50, 23.35s/it] 11%|█         | 4/36 [01:32<12:24, 23.27s/it] 14%|█▍        | 5/36 [01:53<11:40, 22.59s/it] 17%|█▋        | 6/36 [02:18<11:45, 23.52s/it] 19%|█▉        | 7/36 [02:51<12:48, 26.50s/it] 22%|██▏       | 8/36 [03:16<12:10, 26.08s/it] 25%|██▌       | 9/36 [03:52<13:03, 29.03s/it] 28%|██▊       | 10/36 [04:14<11:40, 26.93s/it] 31%|███       | 11/36 [04:42<11:25, 27.44s/it] 33%|███▎      | 12/36 [05:12<11:14, 28.09s/it] 36%|███▌      | 13/36 [05:25<09:00, 23.51s/it] 39%|███▉      | 14/36 [05:54<09:13, 25.16s/it] 42%|████▏     | 15/36 [06:28<09:43, 27.77s/it] 44%|████▍     | 16/36 [06:47<08:23, 25.18s/it] 47%|████▋     | 17/36 [07:13<08:01, 25.33s/it] 50%|█████     | 18/36 [07:50<08:43, 29.07s/it] 53%|█████▎    | 19/36 [08:13<07:43, 27.26s/it] 56%|█████▌    | 20/36 [08:45<07:35, 28.46s/it] 58%|█████▊    | 21/36 [09:01<06:13, 24.89s/it] 61%|██████    | 22/36 [09:22<05:31, 23.69s/it] 64%|██████▍   | 23/36 [09:46<05:08, 23.72s/it] 67%|██████▋   | 24/36 [10:09<04:43, 23.64s/it] 69%|██████▉   | 25/36 [10:33<04:21, 23.78s/it] 72%|███████▏  | 26/36 [10:57<03:56, 23.69s/it] 75%|███████▌  | 27/36 [11:33<04:06, 27.39s/it] 78%|███████▊  | 28/36 [11:48<03:10, 23.78s/it] 81%|████████  | 29/36 [12:13<02:49, 24.17s/it] 83%|████████▎ | 30/36 [12:43<02:34, 25.76s/it] 86%|████████▌ | 31/36 [13:29<02:39, 31.85s/it] 89%|████████▉ | 32/36 [13:55<02:00, 30.02s/it] 92%|█████████▏| 33/36 [14:24<01:29, 29.93s/it] 94%|█████████▍| 34/36 [14:42<00:52, 26.10s/it] 97%|█████████▋| 35/36 [15:00<00:23, 23.93s/it]100%|██████████| 36/36 [15:41<00:00, 29.01s/it]100%|██████████| 36/36 [15:41<00:00, 26.16s/it]
Some weights of RobertaModel were not initialized from the model checkpoint at roberta-large and are newly initialized: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Traceback (most recent call last):
  File "/home/abdelrahman.sadallah/mbzuai/UWFe/evaluate_llm.py", line 293, in <module>
    with open(save_file, 'w') as f:
FileNotFoundError: [Errno 2] No such file or directory: 'outputs/outputs/Meta-Llama-3-8B_metrics_5-shots_True-explicit.txt'
[2024-04-20 23:12:47,005] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 2418569) of binary: /home/abdelrahman.sadallah/mambaforge/envs/nlp/bin/python
Traceback (most recent call last):
  File "/home/abdelrahman.sadallah/mambaforge/envs/nlp/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/abdelrahman.sadallah/mambaforge/envs/nlp/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 347, in wrapper
    return f(*args, **kwargs)
  File "/home/abdelrahman.sadallah/mambaforge/envs/nlp/lib/python3.10/site-packages/torch/distributed/run.py", line 812, in main
    run(args)
  File "/home/abdelrahman.sadallah/mambaforge/envs/nlp/lib/python3.10/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/home/abdelrahman.sadallah/mambaforge/envs/nlp/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/abdelrahman.sadallah/mambaforge/envs/nlp/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
evaluate_llm.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-04-20_23:12:47
  host      : gpu-05
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2418569)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
